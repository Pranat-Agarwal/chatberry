<script>
const token = localStorage.getItem("access_token");

async function loadHistory() {
  const res = await fetch("/api/v1/history", {
    headers: {
      "Authorization": `Bearer ${token}`
    }
  });

  if (!res.ok) {
    document.getElementById("history").innerText = "Failed to load history";
    return;
  }

  const data = await res.json();
  const container = document.getElementById("history");
  container.innerHTML = "";

  if (data.length === 0) {
    container.innerText = "No chat history yet";
    return;
  }

  data.forEach(chat => {
    const div = document.createElement("div");
    div.className = "card";
    div.innerHTML = `
      <b>You:</b> ${chat.message}<br><br>
      <b>ChatBerry:</b> ${chat.response}
    `;
    container.appendChild(div);
  });
}

loadHistory();
</script>
